image: mpretet/image_fiche_opj:latest

stages:
  - script_r
  - render

variables:
  R_LIBS_USER: "$CI_PROJECT_DIR/Rlibs"

before_script:
  - apt-get update && apt-get install -y libmariadb-dev  # Installation des dépendances pour RMySQL
  - R -e "install.packages(c('quarto'))"  # Installation des packages nécessaires

cache:
  paths:
    - Rlibs/

script_r:
  stage: script_r
  script:
    - Rscript fonctions/create_df_one_sp.R

render_quarto:
  stage: render
  script:
    - quarto render maquette_espece_retest.qmd  # Commande pour rendre le document Quarto
  artifacts:
    paths:
      - maquette_espece_retest.html  # Spécifiez le chemin de sortie du rendu Quarto
